---
description: This rule documents the product search functionality in the Infinity Store application, including API integration, service implementation, and UI components for both desktop and mobile views.
globs: 
alwaysApply: false
---
# Product Search Functionality

**Description**: This rule documents the product search functionality in the Infinity Store application, including API integration, service implementation, and UI components for both desktop and mobile views.

## Search API

The product search API endpoint:

```
GET /api/products/search
```

Query parameters:
- `q` (required): Search query string
- `page` (optional): Page number for pagination (default: 1)
- `pageSize` (optional): Number of items per page (default: 10)

The API searches for products matching the query string across product name, description, short description, tags, and category.

## Service Implementation

The search functionality is implemented in [src/services/product/search.ts](mdc:src/services/product/search.ts), which provides the `searchProducts` function to interact with the API.

```typescript
// Simplified example
export const searchProducts = async (
  q: string,
  page: number = 1, 
  pageSize: number = 10
): Promise<ProductSearchResponse> => {
  const endpoint = `${ENDPOINTS.PRODUCT.SEARCH}?q=${encodeURIComponent(q)}&page=${page}&pageSize=${pageSize}`;
  const response = await apiClient.get<ProductSearchResponse>(endpoint);
  return response as unknown as ProductSearchResponse;
};
```

The API endpoint is defined in [src/constants/api.ts](mdc:src/constants/api.ts) as `ENDPOINTS.PRODUCT.SEARCH`.

## UI Components

### Desktop Search

The desktop search component is implemented in [src/components/Search/PLPDesktopSearch.tsx](mdc:src/components/Search/PLPDesktopSearch.tsx). It provides a search input in the header of the site and redirects to the search results page when a query is submitted.

### Mobile Search

Mobile search is implemented in two components:

1. The search bar in the header: [src/components/PLP/Header/Mobile/index.tsx](mdc:src/components/PLP/Header/Mobile/index.tsx)
2. The search modal: [src/components/PLP/Header/Mobile/MobileSearch.tsx](mdc:src/components/PLP/Header/Mobile/MobileSearch.tsx)

Both components redirect to the search results page with the query parameter.

## Search Results

Search results are displayed on the Product Listing Page (PLP) in [src/app/(product)/plp/page.tsx](mdc:src/app/(product)/plp/page.tsx). The page detects the search query parameter and:

1. Calls the search API instead of the regular product listing API
2. Hides the category banner when showing search results
3. Displays a "Results for: [query]" header above the search results

The results are rendered using the standard product list component, maintaining consistent filtering and pagination capabilities.

